!function(e){function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=14)}([function(e,t,r){"use strict";function n(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function a(e){e.data=e.data||{},e.withCk!==!1&&(e.data.ck=c("ck")),e.error=e.error||function(e){return console.log(e)},e.ajaxError=e.ajaxError||function(e){return console.log("无网络连接， 请稍后再试")},$.ajax($.extend({type:e.type||"GET",url:e.url,data:e.data,dataType:e.dataType||"json",timeout:e.timeout,xhrFields:{withCredentials:!0},success:function(t){t.error?e.error?e.error(t.error,t.data,t):console.log(t.error):e.success&&e.success(t)},error:function(t){if(0===t.status)e.ajaxError&&e.ajaxError();else if(400===t.status)e.accessError&&e.accessError();else{var r=$.parseJSON(t.responseText);e.error&&e.error(r.localized_message,r)}},complete:function(t){e.complete&&e.complete()}},e.extra))}function o(e){for(var t={},r=function(t){return e[t]instanceof Function&&!t.match(/^component|^render$|^constructor$/)},a=[].concat(n(Object.keys(e).filter(r))),o=e;o=Object.getPrototypeOf(o);){var s=Object.getOwnPropertyNames(o);if(s.indexOf("setState")>=0)break;a=a.concat(s.filter(r))}return a.forEach(function(r){t[r]=e[r],e[r]=e[r].bind(e)}),t}function s(e){for(var t,r,n,a=location.search.substring(1),o=a.split("&"),s=0,c=o.length;s<c;s++)if(t=o[s].indexOf("="),t!=-1&&(r=o[s].substring(0,t),n=o[s].substring(t+1),e===r))return decodeURIComponent(n);return""}function c(e){var t,r,n=e+"=",a=document.cookie.split(";");for(t=0;t<a.length;t++){for(r=a[t];" "==r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(n))return r.substring(n.length,r.length).replace(/\"/g,"")}return null}Object.defineProperty(t,"__esModule",{value:!0});var u=(window.React&&React.PropTypes,"https://www.douban.com"),i="/api/v2/fanta/",l="https://m.douban.com/rexxar/api/v2/fanta/",f="https://m.douban.com/rexxar/api/v2/${type}/${id}/verify_users",p="https://www.douban.com/service/wallet/api/v2/bran/order/${id}",d="https://www.douban.com/login",h="https://www.douban.com/question/create?user_id=${id}",m=c("ck");t.default={ajax:a,autoBind:o,get_cookie:c,getQuery:s,API:i,REXXAR_API:l,ORDERAPI:p,VERIFY_API:f,CREATE_URL:h,LOGIN_URL:d,ISLOGIN:m,DOUBAN:u}},function(e,t){e.exports=React},function(e,t){e.exports=ReactDOM},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function(e){function t(e){return n(this,t),a(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return o(t,e),s(t,[{key:"renderComment",value:function(){var e=this.props,t=e.author,r=e.items,n=e.total,a=e.classname,o=r[0];return React.createElement("div",{className:"comment "+a},React.createElement("div",{className:"comment-title"},React.createElement("a",{href:o.url},o.title)),React.createElement("div",{className:"comment-content"},o.abstract),r.length>1?React.createElement("div",{className:"more"},"> ",React.createElement("a",{href:"/subject/"+answerObj.SUBJECT_ID+"/comments?author_id="+t.id},"更多自述",n,"篇")):null)}},{key:"renderAnswer",value:function(){var e=this.props,t=e.author,r=e.items,n=e.total,a=e.classname;return React.createElement("div",{className:"comment "+a},React.createElement("ul",{className:"answer-item"},r.map(function(e,t){return React.createElement("li",{key:"q_"+t},React.createElement("a",{className:"nowrap",href:e.url},e.title.length>40?e.title.split(0,40)+"...":e.title),React.createElement("span",{className:"rr"},React.createElement("em",{className:"f-orange"},e.answer&&e.answer.onlook_count)," 已围观"))})),n>3?React.createElement("div",{className:"more"},"> ",React.createElement("a",{href:"https://www.douban.com/people/"+(t&&t.id||answerObj.AUTHOR_ID)+"/questions"},"全部",n,"个问答")):null)}},{key:"render",value:function(){var e=this.props,t=e.tabType,r=(e.items,e.total);return r>0?"reviews"===t?this.renderComment():this.renderAnswer():React.createElement("div",{className:"no-content"},"暂时没有关于此"+this.props.text+"的问答")}}]),t}(React.Component);t.default=c},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),i=n(u),l=r(13),f=n(l),p=r(3),d=n(p),h={book:"图书",movie:"电影",tv:"电视剧",music:"音乐",review:"评论",note:"日记",photo_album:"相册"},m=answerObj,y=m.TYPE,v=m.SUBJECT_ID,b=m.USER_ID,_=void 0===b?"":b,w=m.AUTHOR_ID,E=void 0===w?"":w,R=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={curIndex:0},i.default.autoBind(r),r}return s(t,e),c(t,[{key:"getCreateUrl",value:function(e){return i.default.CREATE_URL.replace("${id}",e)+"&target_id="+v+"&target_type="+y+"&source="+location.href}},{key:"hasType",value:function(){if(y)return["note","photo_album"].indexOf(y)>-1}},{key:"handleTabs",value:function(e){this.setState({curIndex:e})}},{key:"renderTabs",value:function(e){var t=this,r=this.state.curIndex;return 1===e.length?React.createElement("div",{className:"author-tabs"},React.createElement("span",{className:"on default"},e[0]),this.hasType()&&_!==E?React.createElement("a",{className:"btn j a_show_login",href:this.getCreateUrl(E)},"向作者提问"):null):React.createElement("div",{className:"author-tabs"},e.map(function(e,n){return React.createElement("span",{className:n===r?"on":"",onClick:function(){return t.handleTabs(n)}},e)}))}},{key:"renderAuthorDesc",value:function(){var e=this.state.curIndex,t=this.props.verify_user,r=t.user,n=t.reviews,a=t.questions,o=t.review_count,s=void 0===o?0:o,c=t.question_count,u=void 0===c?0:c,i=[];if(!t)return null;if(n&&s>0&&i.push("作者自述 "+(s>0?s:"")),(this.hasType()||a&&u>0)&&i.push("问答 "+(u>0?u:"")),i.length<1)return null;var l="questions",f=u;return n&&s>0&&(l="reviews",f=s),React.createElement("div",{className:"author-desc"},this.renderTabs(i),i.length>1?React.createElement("div",{className:"author-tabcon"},React.createElement(d.default,{author:r,tabType:"reviews",items:n,total:s,text:h[y],classname:0===e?"on":""}),React.createElement(d.default,{author:r,tabType:"questions",items:a,total:u,text:h[y],classname:1===e?"on":""})):React.createElement("div",{className:"author-tabcon"},React.createElement(d.default,{author:r,tabType:l,items:t[l],total:f,text:h[y],classname:"on"})))}},{key:"render",value:function(){var e=this.props.verify_user;if(!e)return null;var t=this.hasType()?E:e&&e.user&&e.user.id;return["review"].indexOf(y)>-1?this.renderAuthorDesc():React.createElement("div",{className:(this.hasType()?"no-border ":"")+"author-item"},e.followers_count,this.hasType()||!e.user?null:React.createElement(f.default,{author:e.user,verify_roles:e.verify_roles,create_question:this.getCreateUrl(t)}),this.renderAuthorDesc())}}]),t}(React.Component);t.default=R},,,,,,function(e,t){},,,function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(0),i=n(u),l=answerObj,f=l.TYPE,p=l.USER_ID,d=void 0===p?"":p,h=function(e){function t(e){a(this,t);var r=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return r.state={isFollowed:e.author&&e.author.followed},i.default.autoBind(r),r}return s(t,e),c(t,[{key:"addcontact",value:function(e){var t=this;i.default.ISLOGIN||(location.href=i.default.LOGIN_URL),i.default.ajax({url:"https://www.douban.com/j/contact/addcontact_for_usercard",type:"POST",dataType:"jsonp",data:{people:e,from:f},success:function(e){t.setState({isFollowed:!0})}})}},{key:"render",value:function(){var e=this.state.isFollowed,t=this.props,r=t.author,n=t.verify_roles,a=t.create_question,o=r.id,s=r.name,c=r.avatar,u=r.url,i=r.followers_count,l=r.verify_type,p=r.fanta_can_ask,h=(4===l?"url(/pics/ic_verify@2x.png), ":"")+"url("+c+")",m=null,y={book:"本书",movie:"本片",tv:"本剧",music:"唱片"};return m=e?React.createElement("span",null,"已关注"):React.createElement("a",{href:"javascript:;",className:"a-btn-add j a_show_login",onClick:this.addcontact.bind(this,o)},"关注"),React.createElement("div",{className:"author-info"},React.createElement("a",{className:"author-link",href:u,target:"_blank",title:s},React.createElement("div",{className:"avatar "+(l?"verify-avatar":""),title:s,style:{backgroundImage:h}}),React.createElement("div",{className:"info"},React.createElement("span",{className:"name"}," ",s," "),React.createElement("span",{className:"verify"},n?y[f]+n:""," / ",i," 人关注"))),d===o?null:React.createElement("div",{className:"rr"},p?[React.createElement("a",{href:a,className:"mr5"},"Q 向他提问"),React.createElement("span",null,"| ")]:null,r.in_blacklist?null:m))}}]),t}(React.Component);t.default=h},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),i=n(u),l=(r(2),r(0)),f=n(l),p=r(4),d=n(p),h=r(3);n(h);r(10),function(){var e=["review","note","photo_album"],t=answerObj,r=t.TYPE,n=t.SUBJECT_ID,u=t.AUTHOR_ID,l=void 0===u?"":u,p=t.ISALL,h=void 0!==p&&p,m=function(t){function u(e){a(this,u);var t=o(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t.state={start:0,count:2,total:0,verify_users:[],curIndex:0,isCanAnswer:!1,author:{}},f.default.autoBind(t),t}return s(u,t),c(u,[{key:"componentDidMount",value:function(){var t=this;this.hasType(e)&&l?f.default.ajax({url:f.default.REXXAR_API+"respondent/"+l,type:"GET",success:function(e){t.setState({author:e,isCanAnswer:e.fanta_can_ask}),t.getQuestion()},accessError:function(){t.setState({isCanAnswer:!1})},error:function(){t.setState({isCanAnswer:!1})}}):this.getQuestion()}},{key:"getQuestion",value:function(){var t=this,a=this.state,o=a.start,s=a.count,c={start:o,count:s},u=f.default.REXXAR_API+"questions",i="json";this.hasType(e)?(c.count=this.hasType(["note","photo_album"])?4:s,c.target_type=r,c.target_id=n):u=f.default.VERIFY_API.replace("${type}",r).replace("${id}",n),f.default.ajax({url:u,type:"GET",data:c,dataType:i,success:function(r){if(t.hasType(e)){var n={};n.question_count=r.total,n.questions=r.questions,t.setState({verify_users:[n],total:r.total})}else t.setState({verify_users:r.verify_users,total:r.total})}})}},{key:"hasType",value:function(e){if(r)return e.indexOf(r)>-1}},{key:"render",value:function(){var t=this;if(this.hasType(e)&&!this.state.isCanAnswer)return null;var r=this.state,a=r.verify_users,o=(r.curIndex,r.author),s="boolean"==typeof h?h:"true"===h.toLowerCase(),c=s?a:a.length>2?a.slice(0,2):a,u=function(){return s?null:!t.hasType(e)&&a.length>0?i.default.createElement("h2",null,"作者在豆瓣 · · · · · · ",i.default.createElement("span",{className:"pl"},"(",i.default.createElement("a",{href:"/subject/"+n+"/creators"},"全部 ",a.length),")")):null};return i.default.createElement("div",{className:"author"},u(),this.hasType(e)?i.default.createElement(d.default,{verify_user:a[0],author:o,getCreateUrl:this.getCreateUrl}):i.default.createElement("div",{className:"author-wrap"},c.map(function(e,r){return i.default.createElement(d.default,{verify_user:e,key:r,getCreateUrl:t.getCreateUrl})})))}}]),u}(i.default.Component);ReactDOM.render(i.default.createElement(m,null),document.getElementById("author-wrapper"))}()}]);